7109315c75f4f60594a0615f838ca6d1
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");
var _slicedToArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/slicedToArray"));
Object.defineProperty(exports, "__esModule", {
  value: true
});
var _exportNames = {
  configure: true,
  fetch: true,
  refresh: true,
  addEventListener: true,
  useNetInfo: true,
  useNetInfoInstance: true
};
exports.configure = configure;
exports.fetch = fetch;
exports.refresh = refresh;
exports.addEventListener = addEventListener;
exports.useNetInfo = useNetInfo;
exports.useNetInfoInstance = useNetInfoInstance;
exports.default = void 0;
var _react = require("react");
var _reactNative = require("react-native");
var _defaultConfiguration = _interopRequireDefault(require("./internal/defaultConfiguration"));
var _nativeInterface = _interopRequireDefault(require("./internal/nativeInterface"));
var _state2 = _interopRequireDefault(require("./internal/state"));
var Types = _interopRequireWildcard(require("./internal/types"));
Object.keys(Types).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;
  if (key in exports && exports[key] === Types[key]) return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return Types[key];
    }
  });
});
function _getRequireWildcardCache(nodeInterop) {
  if (typeof WeakMap !== "function") return null;
  var cacheBabelInterop = new WeakMap();
  var cacheNodeInterop = new WeakMap();
  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {
    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
  })(nodeInterop);
}
function _interopRequireWildcard(obj, nodeInterop) {
  if (!nodeInterop && obj && obj.__esModule) {
    return obj;
  }
  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }
  var cache = _getRequireWildcardCache(nodeInterop);
  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }
  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
  for (var key in obj) {
    if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }
  newObj.default = obj;
  if (cache) {
    cache.set(obj, newObj);
  }
  return newObj;
}
function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}
var _configuration = _defaultConfiguration.default;
var _state = null;
var createState = function createState() {
  return new _state2.default(_configuration);
};
var isRequestInProgress = false;
var requestQueue = [];
function configure(configuration) {
  _configuration = Object.assign({}, _defaultConfiguration.default, configuration);
  if (_state) {
    _state.tearDown();
    _state = createState();
  }
  if (_reactNative.Platform.OS === 'ios') {
    _nativeInterface.default.configure(configuration);
  }
}
function fetch(requestedInterface) {
  if (!_state) {
    _state = createState();
  }
  return _state.latest(requestedInterface);
}
function refresh() {
  if (!_state) {
    _state = createState();
  }
  if (isRequestInProgress) {
    return new Promise(function (resolve) {
      requestQueue.push(resolve);
    });
  }
  isRequestInProgress = true;
  return _state._fetchCurrentState().then(function (result) {
    requestQueue.forEach(function (resolve) {
      return resolve(result);
    });
    requestQueue = [];
    return result;
  }).finally(function () {
    isRequestInProgress = false;
  });
}
function addEventListener(listener) {
  if (!_state) {
    _state = createState();
  }
  _state.add(listener);
  return function () {
    _state && _state.remove(listener);
  };
}
function useNetInfo(configuration) {
  if (configuration) {
    configure(configuration);
  }
  var _ref = (0, _react.useState)({
      type: Types.NetInfoStateType.unknown,
      isConnected: null,
      isInternetReachable: null,
      details: null
    }),
    _ref2 = (0, _slicedToArray2.default)(_ref, 2),
    netInfo = _ref2[0],
    setNetInfo = _ref2[1];
  (0, _react.useEffect)(function () {
    var unsubscribe = addEventListener(setNetInfo);
    return function () {
      return unsubscribe();
    };
  }, []);
  return netInfo;
}
function useNetInfoInstance() {
  var isPaused = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
  var configuration = arguments.length > 1 ? arguments[1] : undefined;
  var _ref3 = (0, _react.useState)(),
    _ref4 = (0, _slicedToArray2.default)(_ref3, 2),
    networkInfoManager = _ref4[0],
    setNetworkInfoManager = _ref4[1];
  var _ref5 = (0, _react.useState)({
      type: Types.NetInfoStateType.unknown,
      isConnected: null,
      isInternetReachable: null,
      details: null
    }),
    _ref6 = (0, _slicedToArray2.default)(_ref5, 2),
    netInfo = _ref6[0],
    setNetInfo = _ref6[1];
  (0, _react.useEffect)(function () {
    if (isPaused) {
      return;
    }
    var config = Object.assign({}, _defaultConfiguration.default, configuration);
    var state = new _state2.default(config);
    setNetworkInfoManager(state);
    state.add(setNetInfo);
    return state.tearDown;
  }, [isPaused, configuration]);
  var refresh = (0, _react.useCallback)(function () {
    if (networkInfoManager && !isRequestInProgress) {
      isRequestInProgress = true;
      networkInfoManager._fetchCurrentState().finally(function () {
        isRequestInProgress = false;
      });
    }
  }, [networkInfoManager]);
  return {
    netInfo: netInfo,
    refresh: refresh
  };
}
var _default = {
  configure: configure,
  fetch: fetch,
  refresh: refresh,
  addEventListener: addEventListener,
  useNetInfo: useNetInfo,
  useNetInfoInstance: useNetInfoInstance
};
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3JlYWN0TmF0aXZlIiwiX2RlZmF1bHRDb25maWd1cmF0aW9uIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9uYXRpdmVJbnRlcmZhY2UiLCJfc3RhdGUyIiwiVHlwZXMiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwia2V5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiX2V4cG9ydE5hbWVzIiwiZXhwb3J0cyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIl9jb25maWd1cmF0aW9uIiwiZGVmYXVsdCIsIl9zdGF0ZSIsImNyZWF0ZVN0YXRlIiwiaXNSZXF1ZXN0SW5Qcm9ncmVzcyIsInJlcXVlc3RRdWV1ZSIsImNvbmZpZ3VyZSIsImNvbmZpZ3VyYXRpb24iLCJhc3NpZ24iLCJ0ZWFyRG93biIsIlBsYXRmb3JtIiwiT1MiLCJmZXRjaCIsInJlcXVlc3RlZEludGVyZmFjZSIsImxhdGVzdCIsInJlZnJlc2giLCJQcm9taXNlIiwicmVzb2x2ZSIsInB1c2giLCJfZmV0Y2hDdXJyZW50U3RhdGUiLCJ0aGVuIiwicmVzdWx0IiwiZmluYWxseSIsImFkZEV2ZW50TGlzdGVuZXIiLCJsaXN0ZW5lciIsImFkZCIsInJlbW92ZSIsInVzZU5ldEluZm8iLCJfcmVmIiwidXNlU3RhdGUiLCJ0eXBlIiwiTmV0SW5mb1N0YXRlVHlwZSIsInVua25vd24iLCJpc0Nvbm5lY3RlZCIsImlzSW50ZXJuZXRSZWFjaGFibGUiLCJkZXRhaWxzIiwiX3JlZjIiLCJfc2xpY2VkVG9BcnJheTIiLCJuZXRJbmZvIiwic2V0TmV0SW5mbyIsInVzZUVmZmVjdCIsInVuc3Vic2NyaWJlIiwidXNlTmV0SW5mb0luc3RhbmNlIiwiaXNQYXVzZWQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJfcmVmMyIsIl9yZWY0IiwibmV0d29ya0luZm9NYW5hZ2VyIiwic2V0TmV0d29ya0luZm9NYW5hZ2VyIiwiX3JlZjUiLCJfcmVmNiIsImNvbmZpZyIsInN0YXRlIiwidXNlQ2FsbGJhY2siXSwic291cmNlcyI6WyJpbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmb3JtYXRcbiAqL1xuXG5pbXBvcnQge3VzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZUNhbGxiYWNrfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1BsYXRmb3JtfSBmcm9tICdyZWFjdC1uYXRpdmUnO1xuaW1wb3J0IERFRkFVTFRfQ09ORklHVVJBVElPTiBmcm9tICcuL2ludGVybmFsL2RlZmF1bHRDb25maWd1cmF0aW9uJztcbmltcG9ydCBOYXRpdmVJbnRlcmZhY2UgZnJvbSAnLi9pbnRlcm5hbC9uYXRpdmVJbnRlcmZhY2UnO1xuaW1wb3J0IFN0YXRlIGZyb20gJy4vaW50ZXJuYWwvc3RhdGUnO1xuaW1wb3J0ICogYXMgVHlwZXMgZnJvbSAnLi9pbnRlcm5hbC90eXBlcyc7XG5cbi8vIFN0b3JlcyB0aGUgY3VycmVudGx5IHVzZWQgY29uZmlndXJhdGlvblxubGV0IF9jb25maWd1cmF0aW9uID0gREVGQVVMVF9DT05GSUdVUkFUSU9OO1xuXG4vLyBTdG9yZXMgdGhlIHNpbmdsZXRvbiByZWZlcmVuY2UgdG8gdGhlIHN0YXRlIG1hbmFnZXJcbmxldCBfc3RhdGU6IFN0YXRlIHwgbnVsbCA9IG51bGw7XG5jb25zdCBjcmVhdGVTdGF0ZSA9ICgpOiBTdGF0ZSA9PiB7XG4gIHJldHVybiBuZXcgU3RhdGUoX2NvbmZpZ3VyYXRpb24pO1xufTtcblxuLy8gVHJhY2sgb25nb2luZyByZXF1ZXN0c1xubGV0IGlzUmVxdWVzdEluUHJvZ3Jlc3MgPSBmYWxzZTtcbmxldCByZXF1ZXN0UXVldWU6ICgoc3RhdGU6IFR5cGVzLk5ldEluZm9TdGF0ZSkgPT4gdm9pZClbXSA9IFtdO1xuXG4vKipcbiAqIENvbmZpZ3VyZXMgdGhlIGxpYnJhcnkgd2l0aCB0aGUgZ2l2ZW4gY29uZmlndXJhdGlvbi4gTm90ZSB0aGF0IGNhbGxpbmcgdGhpcyB3aWxsIHN0b3AgYWxsXG4gKiBwcmV2aW91c2x5IGFkZGVkIGxpc3RlbmVycyBmcm9tIGJlaW5nIGNhbGxlZCBhZ2Fpbi4gSXQgaXMgYmVzdCB0byBjYWxsIHRoaXMgcmlnaHQgd2hlbiB5b3VyXG4gKiBhcHBsaWNhdGlvbiBpcyBzdGFydGVkIHRvIGF2b2lkIGlzc3Vlcy4gVGhlIGNvbmZpZ3VyYXRpb24gc2V0cyB1cCBhIGdsb2JhbCBzaW5nbGV0b24gaW5zdGFuY2UuXG4gKlxuICogQHBhcmFtIGNvbmZpZ3VyYXRpb24gVGhlIG5ldyBjb25maWd1cmF0aW9uIHRvIHNldC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmZpZ3VyZShcbiAgY29uZmlndXJhdGlvbjogUGFydGlhbDxUeXBlcy5OZXRJbmZvQ29uZmlndXJhdGlvbj4sXG4pOiB2b2lkIHtcbiAgX2NvbmZpZ3VyYXRpb24gPSB7XG4gICAgLi4uREVGQVVMVF9DT05GSUdVUkFUSU9OLFxuICAgIC4uLmNvbmZpZ3VyYXRpb24sXG4gIH07XG5cbiAgaWYgKF9zdGF0ZSkge1xuICAgIF9zdGF0ZS50ZWFyRG93bigpO1xuICAgIF9zdGF0ZSA9IGNyZWF0ZVN0YXRlKCk7XG4gIH1cblxuICBpZiAoUGxhdGZvcm0uT1MgPT09ICdpb3MnKSB7XG4gICAgTmF0aXZlSW50ZXJmYWNlLmNvbmZpZ3VyZShjb25maWd1cmF0aW9uKTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSBgUHJvbWlzZWAgdGhhdCByZXNvbHZlcyB0byBhIGBOZXRJbmZvU3RhdGVgIG9iamVjdC5cbiAqIFRoaXMgZnVuY3Rpb24gb3BlcmF0ZXMgb24gdGhlIGdsb2JhbCBzaW5nbGV0b24gaW5zdGFuY2UgY29uZmlndXJlZCB1c2luZyBgY29uZmlndXJlKClgXG4gKlxuICogQHBhcmFtIFtyZXF1ZXN0ZWRJbnRlcmZhY2VdIGludGVyZmFjZSBmcm9tIHdoaWNoIHRvIG9idGFpbiB0aGUgaW5mb3JtYXRpb25cbiAqXG4gKiBAcmV0dXJucyBBIFByb21pc2Ugd2hpY2ggY29udGFpbnMgdGhlIGN1cnJlbnQgY29ubmVjdGlvbiBzdGF0ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZldGNoKFxuICByZXF1ZXN0ZWRJbnRlcmZhY2U/OiBzdHJpbmcsXG4pOiBQcm9taXNlPFR5cGVzLk5ldEluZm9TdGF0ZT4ge1xuICBpZiAoIV9zdGF0ZSkge1xuICAgIF9zdGF0ZSA9IGNyZWF0ZVN0YXRlKCk7XG4gIH1cbiAgcmV0dXJuIF9zdGF0ZS5sYXRlc3QocmVxdWVzdGVkSW50ZXJmYWNlKTtcbn1cblxuLyoqXG4gKiBGb3JjZS1yZWZyZXNoZXMgdGhlIGludGVybmFsIHN0YXRlIG9mIHRoZSBnbG9iYWwgc2luZ2xldG9uIG1hbmFnZWQgYnkgdGhpcyBsaWJyYXJ5LlxuICpcbiAqIEByZXR1cm5zIEEgUHJvbWlzZSB3aGljaCBjb250YWlucyB0aGUgdXBkYXRlZCBjb25uZWN0aW9uIHN0YXRlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVmcmVzaCgpOiBQcm9taXNlPFR5cGVzLk5ldEluZm9TdGF0ZT4ge1xuICBpZiAoIV9zdGF0ZSkge1xuICAgIF9zdGF0ZSA9IGNyZWF0ZVN0YXRlKCk7XG4gIH1cblxuIC8vIElmIGEgcmVxdWVzdCBpcyBhbHJlYWR5IGluIHByb2dyZXNzLCByZXR1cm4gYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHdoZW4gdGhlIGN1cnJlbnQgcmVxdWVzdCBmaW5pc2hlc1xuICBpZiAoaXNSZXF1ZXN0SW5Qcm9ncmVzcykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgcmVxdWVzdFF1ZXVlLnB1c2gocmVzb2x2ZSk7XG4gICAgfSk7XG4gIH1cblxuICBpc1JlcXVlc3RJblByb2dyZXNzID0gdHJ1ZTtcblxuICByZXR1cm4gX3N0YXRlLl9mZXRjaEN1cnJlbnRTdGF0ZSgpLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgIHJlcXVlc3RRdWV1ZS5mb3JFYWNoKChyZXNvbHZlKSA9PiByZXNvbHZlKHJlc3VsdCkpO1xuICAgIHJlcXVlc3RRdWV1ZSA9IFtdO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH0pLmZpbmFsbHkoKCkgPT4ge1xuICAgIGlzUmVxdWVzdEluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgfSk7XG59XG5cbi8qKlxuICogU3Vic2NyaWJlIHRvIHRoZSBnbG9iYWwgc2luZ2xldG9uJ3MgY29ubmVjdGlvbiBpbmZvcm1hdGlvbi4gVGhlIGNhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIGEgcGFyYW1ldGVyIG9mIHR5cGVcbiAqIFtgTmV0SW5mb1N0YXRlYF0oUkVBRE1FLm1kI25ldGluZm9zdGF0ZSkgd2hlbmV2ZXIgdGhlIGNvbm5lY3Rpb24gc3RhdGUgY2hhbmdlcy4gWW91ciBsaXN0ZW5lclxuICogd2lsbCBiZSBjYWxsZWQgd2l0aCB0aGUgbGF0ZXN0IGluZm9ybWF0aW9uIHNvb24gYWZ0ZXIgeW91IHN1YnNjcmliZSBhbmQgdGhlbiB3aXRoIGFueVxuICogc3Vic2VxdWVudCBjaGFuZ2VzIGFmdGVyd2FyZHMuIFlvdSBzaG91bGQgbm90IGFzc3VtZSB0aGF0IHRoZSBsaXN0ZW5lciBpcyBjYWxsZWQgaW4gdGhlIHNhbWVcbiAqIHdheSBhY3Jvc3MgZGV2aWNlcyBvciBwbGF0Zm9ybXMuXG4gKlxuICogQHBhcmFtIGxpc3RlbmVyIFRoZSBsaXN0ZW5lciB3aGljaCBpcyBjYWxsZWQgd2hlbiB0aGUgbmV0d29yayBzdGF0ZSBjaGFuZ2VzLlxuICpcbiAqIEByZXR1cm5zIEEgZnVuY3Rpb24gd2hpY2ggY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIoXG4gIGxpc3RlbmVyOiBUeXBlcy5OZXRJbmZvQ2hhbmdlSGFuZGxlcixcbik6IFR5cGVzLk5ldEluZm9TdWJzY3JpcHRpb24ge1xuICBpZiAoIV9zdGF0ZSkge1xuICAgIF9zdGF0ZSA9IGNyZWF0ZVN0YXRlKCk7XG4gIH1cblxuICBfc3RhdGUuYWRkKGxpc3RlbmVyKTtcbiAgcmV0dXJuICgpOiB2b2lkID0+IHtcbiAgICBfc3RhdGUgJiYgX3N0YXRlLnJlbW92ZShsaXN0ZW5lcik7XG4gIH07XG59XG5cbi8qKlxuICogQSBSZWFjdCBIb29rIGludG8gdGhpcyBsaWJyYXJ5J3Mgc2luZ2xldG9uIHdoaWNoIHVwZGF0ZXMgd2hlbiB0aGUgY29ubmVjdGlvbiBzdGF0ZSBjaGFuZ2VzLlxuICpcbiAqIEBwYXJhbSB7UGFydGlhbDxUeXBlcy5OZXRJbmZvQ29uZmlndXJhdGlvbj59IGNvbmZpZ3VyYXRpb24gLSBDb25maWd1cmUgdGhlIGlzb2xhdGVkIG5ldHdvcmsgY2hlY2tlciBtYW5hZ2VkIGJ5IHRoaXMgaG9va1xuICpcbiAqIEByZXR1cm5zIFRoZSBjb25uZWN0aW9uIHN0YXRlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlTmV0SW5mbyhcbiAgY29uZmlndXJhdGlvbj86IFBhcnRpYWw8VHlwZXMuTmV0SW5mb0NvbmZpZ3VyYXRpb24+LFxuKTogVHlwZXMuTmV0SW5mb1N0YXRlIHtcbiAgaWYgKGNvbmZpZ3VyYXRpb24pIHtcbiAgICBjb25maWd1cmUoY29uZmlndXJhdGlvbik7XG4gIH1cblxuICBjb25zdCBbbmV0SW5mbywgc2V0TmV0SW5mb10gPSB1c2VTdGF0ZTxUeXBlcy5OZXRJbmZvU3RhdGU+KHtcbiAgICB0eXBlOiBUeXBlcy5OZXRJbmZvU3RhdGVUeXBlLnVua25vd24sXG4gICAgaXNDb25uZWN0ZWQ6IG51bGwsXG4gICAgaXNJbnRlcm5ldFJlYWNoYWJsZTogbnVsbCxcbiAgICBkZXRhaWxzOiBudWxsLFxuICB9KTtcblxuICB1c2VFZmZlY3QoKCk6ICgoKSA9PiB2b2lkKSA9PiB7XG4gICAgY29uc3QgdW5zdWJzY3JpYmUgPSBhZGRFdmVudExpc3RlbmVyKHNldE5ldEluZm8pO1xuICAgIHJldHVybiAoKSA9PiB1bnN1YnNjcmliZSgpO1xuICB9LCBbXSk7XG5cbiAgcmV0dXJuIG5ldEluZm87XG59XG5cbi8qKlxuICogQSBSZWFjdCBIb29rIHdoaWNoIG1hbmFnZXMgYW4gaXNvbGF0ZWQgaW5zdGFuY2Ugb2YgdGhlIG5ldHdvcmsgaW5mbyBtYW5hZ2VyLlxuICogVGhpcyBpcyBub3QgYSBob29rIGludG8gYSBzaW5nbGV0b24gc2hhcmVkIHN0YXRlLiBOZXRJbmZvLmNvbmZpZ3VyZSwgTmV0SW5mby5hZGRFdmVudExpc3RlbmVyLFxuICogTmV0SW5mby5mZXRjaCwgTmV0SW5mby5yZWZyZXNoIGFyZSBwZXJmb3JtZWQgb24gYSBnbG9iYWwgc2luZ2xldG9uIGFuZCBoYXZlIG5vIGFmZmVjdCBvbiB0aGlzIGhvb2suXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGlzUGF1c2VkIC0gUGF1c2UgdGhlIGludGVybmFsIG5ldHdvcmsgY2hlY2tzLlxuICogQHBhcmFtIHtQYXJ0aWFsPFR5cGVzLk5ldEluZm9Db25maWd1cmF0aW9uPn0gY29uZmlndXJhdGlvbiAtIENvbmZpZ3VyZSB0aGUgaXNvbGF0ZWQgbmV0d29yayBjaGVja2VyIG1hbmFnZWQgYnkgdGhpcyBob29rXG4gKlxuICogQHJldHVybnMgdGhlIG5ldEluZm8gc3RhdGUgYW5kIGEgcmVmcmVzaCBmdW5jdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlTmV0SW5mb0luc3RhbmNlKFxuICBpc1BhdXNlZCA9IGZhbHNlLFxuICBjb25maWd1cmF0aW9uPzogUGFydGlhbDxUeXBlcy5OZXRJbmZvQ29uZmlndXJhdGlvbj4sXG4pIHtcbiAgY29uc3QgW25ldHdvcmtJbmZvTWFuYWdlciwgc2V0TmV0d29ya0luZm9NYW5hZ2VyXSA9IHVzZVN0YXRlPFN0YXRlPigpO1xuICBjb25zdCBbbmV0SW5mbywgc2V0TmV0SW5mb10gPSB1c2VTdGF0ZTxUeXBlcy5OZXRJbmZvU3RhdGU+KHtcbiAgICB0eXBlOiBUeXBlcy5OZXRJbmZvU3RhdGVUeXBlLnVua25vd24sXG4gICAgaXNDb25uZWN0ZWQ6IG51bGwsXG4gICAgaXNJbnRlcm5ldFJlYWNoYWJsZTogbnVsbCxcbiAgICBkZXRhaWxzOiBudWxsLFxuICB9KTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChpc1BhdXNlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAuLi5ERUZBVUxUX0NPTkZJR1VSQVRJT04sXG4gICAgICAuLi5jb25maWd1cmF0aW9uLFxuICAgIH07XG4gICAgY29uc3Qgc3RhdGUgPSBuZXcgU3RhdGUoY29uZmlnKTtcbiAgICBzZXROZXR3b3JrSW5mb01hbmFnZXIoc3RhdGUpO1xuICAgIHN0YXRlLmFkZChzZXROZXRJbmZvKTtcbiAgICByZXR1cm4gc3RhdGUudGVhckRvd247XG4gIH0sIFtpc1BhdXNlZCwgY29uZmlndXJhdGlvbl0pO1xuXG4gIGNvbnN0IHJlZnJlc2ggPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKG5ldHdvcmtJbmZvTWFuYWdlciAmJiAhaXNSZXF1ZXN0SW5Qcm9ncmVzcykge1xuICAgICAgaXNSZXF1ZXN0SW5Qcm9ncmVzcyA9IHRydWU7XG4gICAgICBuZXR3b3JrSW5mb01hbmFnZXIuX2ZldGNoQ3VycmVudFN0YXRlKCkuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIGlzUmVxdWVzdEluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwgW25ldHdvcmtJbmZvTWFuYWdlcl0pO1xuXG4gIHJldHVybiB7XG4gICAgbmV0SW5mbyxcbiAgICByZWZyZXNoLFxuICB9O1xufVxuXG5leHBvcnQgKiBmcm9tICcuL2ludGVybmFsL3R5cGVzJztcblxuZXhwb3J0IGRlZmF1bHQge1xuICBjb25maWd1cmUsXG4gIGZldGNoLFxuICByZWZyZXNoLFxuICBhZGRFdmVudExpc3RlbmVyLFxuICB1c2VOZXRJbmZvLFxuICB1c2VOZXRJbmZvSW5zdGFuY2UsXG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBU0EsSUFBQUEsTUFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsWUFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUscUJBQUEsR0FBQUMsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFJLGdCQUFBLEdBQUFELHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBSyxPQUFBLEdBQUFGLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBTSxLQUFBLEdBQUFDLHVCQUFBLENBQUFQLE9BQUE7QUE0TEFRLE1BQUEsQ0FBQUMsSUFBQSxDQUFBSCxLQUFBLEVBQUFJLE9BQUEsV0FBQUMsR0FBQTtFQUFBLElBQUFBLEdBQUEsa0JBQUFBLEdBQUE7RUFBQSxJQUFBSCxNQUFBLENBQUFJLFNBQUEsQ0FBQUMsY0FBQSxDQUFBQyxJQUFBLENBQUFDLFlBQUEsRUFBQUosR0FBQTtFQUFBLElBQUFBLEdBQUEsSUFBQUssT0FBQSxJQUFBQSxPQUFBLENBQUFMLEdBQUEsTUFBQUwsS0FBQSxDQUFBSyxHQUFBO0VBQUFILE1BQUEsQ0FBQVMsY0FBQSxDQUFBRCxPQUFBLEVBQUFMLEdBQUE7SUFBQU8sVUFBQTtJQUFBQyxHQUFBLFdBQUFBLElBQUE7TUFBQSxPQUFBYixLQUFBLENBQUFLLEdBQUE7SUFBQTtFQUFBO0FBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXpMQSxJQUFJUyxjQUFjLEdBQUdsQixxQkFBQSxDQUFBbUIsT0FBckI7QUFHQSxJQUFJQyxNQUFvQixHQUFHLElBQTNCO0FBQ0EsSUFBTUMsV0FBVyxHQUFHLFNBQWRBLFdBQVdBLENBQUEsRUFBZ0I7RUFDL0IsT0FBTyxJQUFJbEIsT0FBQSxDQUFBZ0IsT0FBSixDQUFVRCxjQUFW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